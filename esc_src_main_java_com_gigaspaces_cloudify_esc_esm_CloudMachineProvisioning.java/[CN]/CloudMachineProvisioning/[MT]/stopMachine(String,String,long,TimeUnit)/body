{
  logger.fine("Check that we are not shutting down LUS or ESM - lusIP  in locators: " + config.getLocator());
  if (config.getLocator() != null && config.getLocator().contains(ip)) {
    logger.info("Recieved scale in request for LUS/ESM server. Ignoring.");
    return false;
  }
  final Long previousRequest=stoppingMachines.get(ip);
  if ((previousRequest != null) && (System.currentTimeMillis() - previousRequest < MULTIPLE_SHUTDOWN_REQUEST_IGNORE_TIMEOUT)) {
    return true;
  }
  stoppingMachines.put(ip,System.currentTimeMillis());
  logger.info("Scale IN -- " + ip + " --");
  logger.fine("Looking Up Cloud server with this IP");
  final NodeMetadata server=getServerWithIP(ip);
  if (server != null) {
    logger.info("Found server: " + server.getId() + ". Shutting it down");
    deployer.shutdownMachine(server.getId());
    logger.info("Server: " + server.getId() + " shutdown has started.");
    return true;
  }
 else {
    logger.log(Level.SEVERE,"Recieved scale in request for machine with ip " + ip + " "+ "and id "+ agentUid+ " but this IP "+ "could not be found in the Cloud server list");
  }
  return false;
}
