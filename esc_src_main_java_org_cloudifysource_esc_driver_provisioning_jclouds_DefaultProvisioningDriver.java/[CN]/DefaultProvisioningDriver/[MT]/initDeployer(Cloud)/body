{
  if (this.deployer != null) {
    return;
  }
  logger.fine("Creating jclouds context deployer with user: " + cloud.getUser().getUser());
  final CloudTemplate cloudTemplate=cloud.getTemplates().get(cloudTemplateName);
  try {
    final Properties props=new Properties();
    props.putAll(cloudTemplate.getOverrides());
    this.deployer=new JCloudsDeployer(cloud.getProvider().getProvider(),cloud.getUser().getUser(),cloud.getUser().getApiKey(),props);
    this.deployer.setImageId(cloudTemplate.getImageId());
    this.deployer.setMinRamMegabytes(cloudTemplate.getMachineMemoryMB());
    this.deployer.setHardwareId(cloudTemplate.getHardwareId());
    this.deployer.setLocationId(cloudTemplate.getLocationId());
    this.deployer.setExtraOptions(cloudTemplate.getOptions());
  }
 catch (  final IOException e) {
    publishEvent("connection_to_cloud_api_failed",cloud.getProvider().getProvider());
    throw new IllegalStateException("Failed to create cloud Deployer",e);
  }
}
