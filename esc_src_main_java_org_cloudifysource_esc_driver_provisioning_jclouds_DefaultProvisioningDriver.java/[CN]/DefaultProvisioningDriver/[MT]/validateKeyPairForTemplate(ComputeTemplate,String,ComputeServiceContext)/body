{
  String locationId=template.getLocationId();
  if (StringUtils.isBlank(locationId) && apiId.equalsIgnoreCase(OPENSTACK_API)) {
    locationId=getOpenstackLocationByHardwareId(template.getHardwareId());
  }
  if (StringUtils.isBlank(locationId)) {
    throw new CloudProvisioningException("locationId is missing");
  }
  String keyPairName=(String)template.getOptions().get("keyPairName");
  if (keyPairName == null) {
    keyPairName=(String)template.getOptions().get("keyPair");
  }
  if (StringUtils.isNotBlank(keyPairName)) {
    if (apiId.equalsIgnoreCase(EC2_API)) {
      validateEC2KeyPair(computeServiceContext,locationId,keyPairName);
    }
 else     if (apiId.equalsIgnoreCase(OPENSTACK_API)) {
      validateOpenstackKeyPair(computeServiceContext,locationId,keyPairName);
    }
 else     if (apiId.equalsIgnoreCase(CLOUDSTACK)) {
    }
 else     if (apiId.equalsIgnoreCase(VCLOUD)) {
    }
 else {
    }
  }
}
