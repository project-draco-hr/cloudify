{
  logger.fine("Copying files to: " + host + " from local dir: "+ localDir.getName().getPath()+ " excluding "+ excludedFiles.toString());
  try {
    remoteDir.copyFrom(localDir,new FileSelector(){
      @Override public boolean includeFile(      final FileSelectInfo fileInfo) throws Exception {
        if (excludedFiles.contains(fileInfo.getFile().getName().getBaseName())) {
          logger.fine(fileInfo.getFile().getName().getBaseName() + " excluded");
          return false;
        }
        final FileObject remoteFile=fileSystemManager.resolveFile(remoteDir,localDir.getName().getRelativeName(fileInfo.getFile().getName()));
        if (!remoteFile.exists()) {
          logger.fine(fileInfo.getFile().getName().getBaseName() + " missing on server");
          return true;
        }
        if (fileInfo.getFile().getType() == FileType.FILE) {
          final long remoteSize=remoteFile.getContent().getSize();
          final long localSize=fileInfo.getFile().getContent().getSize();
          final boolean res=localSize != remoteSize;
          if (res) {
            logger.fine(fileInfo.getFile().getName().getBaseName() + " different on server");
          }
          return res;
        }
        return false;
      }
      @Override public boolean traverseDescendents(      final FileSelectInfo fileInfo) throws Exception {
        return true;
      }
    }
);
    logger.fine("Copying files to: " + host + " completed.");
  }
 catch (  final FileSystemException e) {
    throw new InstallerException("Failed to copy files to remote host " + host + ": "+ e.getMessage(),e);
  }
  checkTimeout(endTimeMillis);
}
