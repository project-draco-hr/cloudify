{
  if (authentication == null || authentication instanceof AnonymousAuthenticationToken) {
    throw new AccessDeniedException("Anonymous user is not supported");
  }
  if (!(authentication instanceof CustomAuthenticationToken)) {
    throw new AccessDeniedException("Authentication object type not supported");
  }
  return ((CustomAuthenticationToken)authentication).getAuthGroups();
}
