{
  boolean permissionGranted=false;
  Collection<String> userAuthGroups=((CustomAuthenticationToken)authentication).getAuthGroups();
  Collection<String> targetAuthGroups=org.cloudifysource.esc.util.StringUtils.splitAndTrimString(targetAuthGroupsStr,AUTH_GROUPS_DELIMITER);
  if (permissionName.equalsIgnoreCase(PERMISSION_TO_VIEW)) {
    if (hasPermissionToView(targetAuthGroups)) {
      permissionGranted=true;
      logger.log(Level.INFO,"View permission granted for user " + authentication.getName());
    }
 else {
      logger.log(Level.WARNING,"Insufficient permissions. User " + authentication.getName() + " is only "+ "permitted to view groups: "+ Arrays.toString(userAuthGroups.toArray(new String[0])));
    }
  }
 else   if (permissionName.equalsIgnoreCase(PERMISSION_TO_DEPLOY)) {
    if (hasPermissionToDeploy(targetAuthGroups)) {
      permissionGranted=true;
      logger.log(Level.INFO,"Deploy permission granted for user " + authentication.getName());
    }
 else {
      logger.log(Level.WARNING,"Insufficient permissions. User " + authentication.getName() + " is only "+ "permitted to deploy for groups: "+ Arrays.toString(userAuthGroups.toArray(new String[0])));
    }
  }
  return permissionGranted;
}
