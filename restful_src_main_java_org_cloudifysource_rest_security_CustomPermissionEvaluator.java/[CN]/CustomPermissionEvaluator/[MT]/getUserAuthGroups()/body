{
  Set<String> userAuthGroups=new HashSet<String>();
  if (StringUtils.isNotBlank(IS_SPRING_SECURED) && IS_SPRING_SECURED.equalsIgnoreCase("true")) {
    Authentication authentication=SecurityContextHolder.getContext().getAuthentication();
    if (authentication == null || authentication instanceof AnonymousAuthenticationToken) {
      throw new AccessDeniedException("Anonymous user is not supported");
    }
    for (    GrantedAuthority authority : authentication.getAuthorities()) {
      userAuthGroups.add(authority.getAuthority());
    }
  }
  return userAuthGroups;
}
