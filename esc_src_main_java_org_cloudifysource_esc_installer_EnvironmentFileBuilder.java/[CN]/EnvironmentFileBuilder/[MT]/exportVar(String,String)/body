{
  logger.fine("exporting var: " + name + " with value "+ value);
  String actualValue=value;
  if (value == null) {
    actualValue="";
  }
switch (this.scriptLanguage) {
case LINUX_SHELL:
    sb.append("export ").append(name).append("=").append(actualValue);
  break;
case WINDOWS_BATCH:
if (actualValue.startsWith("\"") && actualValue.endsWith("\"")) {
  actualValue=actualValue.substring(1,actualValue.length() - 1);
}
String normalizedValue=normalizeCifsPath(actualValue);
boolean includesAmpersand=false;
if (normalizedValue.contains("&") || normalizedValue.contains("%")) {
normalizedValue=normalizedValue.replace("&","^&");
normalizedValue=normalizedValue.replace("%","%%");
includesAmpersand=true;
}
if (includesAmpersand) {
sb.append("SET \"").append(name).append("=").append(normalizedValue).append("\"");
}
 else {
sb.append("SET ").append(name).append("=").append(normalizedValue);
}
break;
default :
throw new IllegalArgumentException("Unsupported script language: " + this.scriptLanguage);
}
sb.append(newline);
return this;
}
