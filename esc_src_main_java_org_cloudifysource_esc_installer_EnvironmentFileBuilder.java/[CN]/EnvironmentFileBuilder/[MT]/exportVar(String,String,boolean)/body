{
  String actualValue=value;
  if (value == null) {
    actualValue="";
  }
  if (append) {
    actualValue=appendValue(name,value);
  }
  final String externalValue=externalEnvVars.get(name);
  if (!StringUtils.isEmpty(externalValue)) {
    actualValue=appendExternalValue(name,actualValue,externalValue);
    appendedExternalEnvVars.add(name);
  }
  return addValue(name,actualValue);
}
