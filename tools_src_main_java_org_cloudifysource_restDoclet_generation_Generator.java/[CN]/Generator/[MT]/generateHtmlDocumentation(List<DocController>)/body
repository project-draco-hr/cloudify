{
  logger.log(Level.INFO,"Generate velocity using template: " + velocityTemplatePath + " ("+ (isUserDefineTemplatePath ? "got template path from user" : "default template path")+ ")");
  Properties p=new Properties();
  if (isUserDefineTemplatePath) {
    p.setProperty("file.resource.loader.path",velocityTemplatePath);
  }
 else {
    p.setProperty(RuntimeConstants.RESOURCE_LOADER,"classpath");
    p.setProperty("classpath.resource.loader.class",ClasspathResourceLoader.class.getName());
  }
  Velocity.init(p);
  VelocityContext ctx=new VelocityContext();
  ctx.put("controllers",controllers);
  ctx.put("version",version);
  Writer writer=new StringWriter();
  Template template=Velocity.getTemplate(velocityTemplateFileName);
  template.merge(ctx,writer);
  return writer.toString();
}
