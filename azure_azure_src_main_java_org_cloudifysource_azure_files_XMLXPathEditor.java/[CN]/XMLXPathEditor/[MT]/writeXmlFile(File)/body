{
  FileOutputStream fos=null;
  try {
    Source source=new DOMSource(document);
    fos=new FileOutputStream(file);
    Result result=new StreamResult(fos);
    Transformer xformer=TransformerFactory.newInstance().newTransformer();
    xformer.transform(source,result);
    return file;
  }
 catch (  TransformerException e) {
    throw new XMLXPathEditorException(e);
  }
catch (  FileNotFoundException e) {
    throw new XMLXPathEditorException(e);
  }
 finally {
    if (fos != null) {
      try {
        fos.close();
      }
 catch (      IOException e) {
        throw new XMLXPathEditorException(e);
      }
    }
  }
}
