{
  if (deploymentId == null) {
    throw new RestErrorException(CloudifyErrorMessages.MISSING_DEPLOYMENT_ID.getName(),"getLastDeploymentEvent");
  }
  verifyDeploymentIdExists(deploymentId);
  EventsCacheKey key=new EventsCacheKey(deploymentId);
  logger.fine(EventsUtils.getThreadId() + " Received request for last event of key : " + key);
  EventsCacheValue value;
  try {
    logger.fine(EventsUtils.getThreadId() + " Retrieving events from cache for key : " + key);
    value=eventsCache.get(key);
  }
 catch (  final ExecutionException e) {
    throw e.getCause();
  }
synchronized (value.getMutex()) {
    eventsCache.refresh(key);
    int lastEventId=value.getLastEventIndex();
    return EventsUtils.extractDesiredEvents(value.getEvents(),lastEventId,lastEventId);
  }
}
