{
  ServiceDetails serviceDetails=null;
  Application application=admin.getApplications().waitFor(appName,DEFAULT_ADMIN_WAITING_TIMEOUT,TimeUnit.SECONDS);
  if (application == null) {
    throw new RestErrorException(CloudifyMessageKeys.APPLICATION_WAIT_TIMEOUT.getName(),appName,DEFAULT_ADMIN_WAITING_TIMEOUT,TimeUnit.SECONDS);
  }
  ProcessingUnit processingUnit=application.getProcessingUnits().waitFor(ServiceUtils.getAbsolutePUName(appName,serviceName),DEFAULT_ADMIN_WAITING_TIMEOUT,TimeUnit.SECONDS);
  if (processingUnit == null) {
    throw new RestErrorException(CloudifyMessageKeys.SERVICE_WAIT_TIMEOUT.getName(),serviceName,DEFAULT_ADMIN_WAITING_TIMEOUT,TimeUnit.SECONDS);
  }
  serviceDetails=new ServiceDetails(serviceName);
  Map<String,org.openspaces.pu.service.ServiceDetails> instancesDetails=new HashMap<String,org.openspaces.pu.service.ServiceDetails>();
  for (  ProcessingUnitInstance instance : processingUnit.getInstances()) {
    instancesDetails.put(instance.getProcessingUnitInstanceName(),instance.getServiceDetailsByServiceId("USM"));
  }
  serviceDetails.setInstancesDetails(instancesDetails);
  return serviceDetails;
}
