{
  StringBuilder invocationSuccessStringBuilder=new StringBuilder();
  StringBuilder invocationFailedStringBuilder=new StringBuilder();
  invocationSuccessStringBuilder.append("Invocation results: " + System.getProperty("line.separator"));
  String applicationName=this.getCurrentApplicationName();
  if (applicationName == null) {
    applicationName="default";
  }
  Map<String,String> paramsMap=new HashMap<String,String>();
  if (params != null) {
    paramsMap=getParamsMap(params);
  }
  if (instanceId == null) {
    Map<String,InvocationResult> result=adminFacade.invokeServiceCommand(applicationName,serviceName,beanName,commandName,paramsMap);
    Collection<InvocationResult> values=result.values();
    List<InvocationResult> valuesList=new ArrayList<InvocationResult>(values);
    Collections.sort(valuesList);
    for (    InvocationResult invocationResult : valuesList) {
      if (invocationResult.isSuccess()) {
        String successMessage=getFormattedMessage("invocation_success",invocationResult.getInstanceId(),invocationResult.getInstanceName(),invocationResult.getResult());
        invocationSuccessStringBuilder.append(successMessage + System.getProperty("line.separator"));
      }
 else {
        String failedMessage=getFormattedMessage("invocation_failed",invocationResult.getInstanceId(),invocationResult.getInstanceName(),invocationResult.getExceptionMessage());
        invocationFailedStringBuilder.append(failedMessage + System.getProperty("line.separator"));
      }
    }
  }
 else {
    InvocationResult invocationResult=adminFacade.invokeInstanceCommand(applicationName,serviceName,beanName,instanceId,commandName,paramsMap);
    if (invocationResult.isSuccess()) {
      String successMessage=getFormattedMessage("invocation_success",invocationResult.getInstanceId(),invocationResult.getInstanceName(),invocationResult.getResult());
      invocationSuccessStringBuilder.append(successMessage + System.getProperty("line.separator"));
    }
 else {
      String failedMessage=getFormattedMessage("invocation_failed",invocationResult.getInstanceId(),invocationResult.getInstanceName(),invocationResult.getExceptionMessage());
      invocationFailedStringBuilder.append(failedMessage + System.getProperty("line.separator"));
    }
  }
  logger.info(invocationSuccessStringBuilder.toString());
  if (invocationFailedStringBuilder.length() != 0) {
    throw new CLIStatusException("not_all_invocations_completed_successfully",this.serviceName,invocationFailedStringBuilder.toString());
  }
  return getFormattedMessage("all_invocations_completed_successfully");
}
