{
  try {
    final X509TrustManager trustManager=createTrustManager();
    final SSLContext ctx=SSLContext.getInstance("TLS");
    ctx.init(null,new TrustManager[]{trustManager},null);
    final SSLSocketFactory ssf=new SSLSocketFactory(ctx,createHostnameVerifier());
    final AbstractHttpClient base=new DefaultHttpClient();
    final ClientConnectionManager ccm=base.getConnectionManager();
    final SchemeRegistry sr=ccm.getSchemeRegistry();
    sr.register(new Scheme(HTTPS,url.getPort(),ssf));
    return new DefaultHttpClient(ccm,base.getParams());
  }
 catch (  final Exception e) {
    throw new RestClientException(FAILED_CREATING_CLIENT,"Failed creating http client",ExceptionUtils.getFullStackTrace(e));
  }
}
