{
  if (target == null) {
    StringBuilder authGroups=new StringBuilder();
    if (authentication instanceof CustomAuthenticationToken) {
      for (      String authGroup : ((CustomAuthenticationToken)authentication).getAuthGroups()) {
        if (authGroups.length() > 0) {
          authGroups.append(", ");
        }
        authGroups.append(authGroup);
      }
    }
    target=authGroups.toString();
  }
  return permissionEvaluator.hasPermission(authentication,target,permission);
}
