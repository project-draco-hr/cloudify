{
  if (target == null) {
    StringBuffer authGroups=new StringBuffer();
    for (    GrantedAuthority authority : authentication.getAuthorities()) {
      if (authGroups.length() > 0) {
        authGroups.append(", ");
      }
      authGroups.append(authority.getAuthority());
    }
    target=authGroups.toString();
  }
  return permissionEvaluator.hasPermission(authentication,target,permission);
}
