{
  String absolutePuName=ServiceUtils.getAbsolutePUName(applicationName,serviceName);
  ProcessingUnit processingUnit=admin.getProcessingUnits().getProcessingUnit(absolutePuName);
  if (processingUnit != null) {
    Map<String,String> elasticProperties=((DefaultProcessingUnit)processingUnit).getElasticProperties();
    if (elasticProperties.containsKey("schema")) {
      String clusterSchemaValue=elasticProperties.get("schema");
      if ("partitioned-sync2backup".equals(clusterSchemaValue)) {
        return processingUnit.getTotalNumberOfInstances();
      }
    }
  }
  return serviceNames.get(serviceName);
}
