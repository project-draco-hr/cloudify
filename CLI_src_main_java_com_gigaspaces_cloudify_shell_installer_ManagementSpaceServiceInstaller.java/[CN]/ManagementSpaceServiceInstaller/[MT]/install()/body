{
  if (zone == null) {
    throw new IllegalStateException("Management services must be installed on management zone");
  }
  final ElasticSpaceDeployment deployment=new ElasticSpaceDeployment(serviceName).memoryCapacityPerContainer(memoryInMB,MemoryUnit.MEGABYTES).highlyAvailable(highlyAvailable).numberOfPartitions(1).sharedMachineProvisioning("public",new DiscoveredMachineProvisioningConfigurer().addGridServiceAgentZone(zone).reservedMemoryCapacityPerMachine(RESERVED_MEMORY_IN_MB,MemoryUnit.MEGABYTES).create()).scale(new EagerScaleConfigurer().atMostOneContainerPerMachine().create());
  for (  Entry<Object,Object> prop : getContextProperties().entrySet()) {
    deployment.addContextProperty(prop.getKey().toString(),prop.getValue().toString());
  }
  getGridServiceManager().deploy(deployment);
}
