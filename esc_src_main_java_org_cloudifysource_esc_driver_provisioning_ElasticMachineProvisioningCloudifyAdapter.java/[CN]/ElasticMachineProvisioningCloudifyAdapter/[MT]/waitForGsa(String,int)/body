{
  final long endTime=System.currentTimeMillis() + timeoutInSeconds * MILLISECONDS_IN_SECOND;
  while (System.currentTimeMillis() < endTime) {
    GridServiceAgent gsa=admin.getGridServiceAgents().getHostAddress().get(machineIp);
    if (gsa != null) {
      return gsa;
    }
    gsa=admin.getGridServiceAgents().getHostNames().get(machineIp);
    if (gsa != null) {
      return gsa;
    }
    Thread.sleep(MILLISECONDS_IN_SECOND);
  }
  return null;
}
