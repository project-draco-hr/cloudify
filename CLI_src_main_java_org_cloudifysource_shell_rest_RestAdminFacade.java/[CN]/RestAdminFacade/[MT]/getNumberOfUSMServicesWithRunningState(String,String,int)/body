{
  final String absolutePUName=ServiceUtils.getAbsolutePUName(applicationName,serviceName);
  final String serviceMonitorsUrl="ProcessingUnits/Names/" + absolutePUName + "/ProcessingUnitInstances/%d/Statistics/Monitors/USM/Monitors/"+ CloudifyConstants.USM_MONITORS_STATE_ID;
  int runningServiceInstanceCounter=0;
  try {
    for (int i=0; i < currentNumberOfInstances; i++) {
      final String instanceUrl=String.format(serviceMonitorsUrl,i);
      final Map<String,Object> map=client.getAdminData(instanceUrl);
      final int instanceState=Integer.parseInt((String)map.get(CloudifyConstants.USM_MONITORS_STATE_ID));
      if (CloudifyConstants.USMState.values()[instanceState] == CloudifyConstants.USMState.RUNNING) {
        runningServiceInstanceCounter++;
      }
    }
  }
 catch (  final ErrorStatusException e) {
    throw new CLIStatusException(e,e.getReasonCode(),e.getArgs());
  }
catch (  final RestException e) {
    throw new CLIException(e);
  }
  return runningServiceInstanceCounter;
}
