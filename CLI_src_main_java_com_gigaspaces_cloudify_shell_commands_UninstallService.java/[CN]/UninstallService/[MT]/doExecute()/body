{
  if (!askUninstallConfirmationQuestion()) {
    return getFormattedMessage("uninstall_aborted");
  }
  final Set<String> containerIdsOfService=((RestAdminFacade)adminFacade).getGridServiceContainerUidsForService(getCurrentApplicationName(),serviceName);
  if (verbose) {
    logger.info("Found containers: " + containerIdsOfService);
  }
  if (timeoutInMinutes > 0) {
    printStatusMessage(containerIdsOfService.size(),containerIdsOfService.size(),containerIdsOfService);
  }
  adminFacade.undeploy(getCurrentApplicationName(),serviceName);
  if (timeoutInMinutes > 0) {
    createConditionLatch(timeoutInMinutes,TimeUnit.MINUTES).waitFor(new Predicate(){
      @Override public boolean isDone() throws CLIException {
        Set<String> allContainerIds=((RestAdminFacade)adminFacade).getGridServiceContainerUids();
        Set<String> remainingContainersForService=new HashSet<String>(containerIdsOfService);
        remainingContainersForService.retainAll(allContainerIds);
        boolean isDone=remainingContainersForService.isEmpty();
        if (!isDone) {
          printStatusMessage(remainingContainersForService.size(),containerIdsOfService.size(),remainingContainersForService);
        }
        return isDone;
      }
    }
);
  }
  return getFormattedMessage("undeployed_successfully",serviceName);
}
