{
  if (timeoutInMinutes < 0) {
    throw new CLIException("-timeout cannot be negative");
  }
  boolean notHighlyAvailableManagementSpace=false;
  File cloudFile=null;
  String cloudConfigurationContents=null;
  if (cloudFileName != null && cloudFileName.trim().length() > 0) {
    cloudFile=new File(cloudFileName);
    cloudConfigurationContents=FileUtils.readFileToString(cloudFile);
    Cloud2 cloud=parseCloud(cloudFile);
    if (cloud != null) {
      if (cloud.getProvider() != null) {
        int numberOfManagementMachines=cloud.getProvider().getNumberOfManagementMachines();
        notHighlyAvailableManagementSpace=numberOfManagementMachines < 2;
      }
    }
  }
  LocalhostGridAgentBootstrapper installer=new LocalhostGridAgentBootstrapper();
  installer.setVerbose(verbose);
  installer.setLookupGroups(lookupGroups);
  installer.setLookupLocators(lookupLocators);
  installer.setNicAddress(nicAddress);
  installer.setProgressInSeconds(10);
  installer.setAdminFacade((AdminFacade)session.get(Constants.ADMIN_FACADE));
  installer.setNoWebServices(noWebServices);
  installer.setNoManagementSpace(noManagementSpace);
  installer.setNotHighlyAvailableManagementSpace(notHighlyAvailableManagementSpace);
  installer.setAutoShutdown(autoShutdown);
  installer.setWaitForWebui(true);
  installer.setCloudContents(cloudConfigurationContents);
  installer.startManagementOnLocalhostAndWait(timeoutInMinutes,TimeUnit.MINUTES);
  return "Management started succesfully. Use the shutdown-management command to shutdown management processes running on local machine.";
}
