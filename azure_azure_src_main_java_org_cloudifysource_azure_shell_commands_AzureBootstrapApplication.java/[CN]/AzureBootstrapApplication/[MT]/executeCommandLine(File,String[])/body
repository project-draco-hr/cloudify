{
  try {
    final ProcessBuilder pb=new ProcessBuilder(cmd);
    pb.redirectErrorStream(true);
    final StringBuilder sb=new StringBuilder();
    pb.directory(workingDirectory);
    logger.fine("Executing command: " + Arrays.toString(cmd));
    final Process p=pb.start();
    final BufferedReader reader=new BufferedReader(new InputStreamReader(p.getInputStream()));
    String line=reader.readLine();
    while (line != null) {
      sb.append(line).append('\n');
      line=reader.readLine();
    }
    final String readResult=sb.toString();
    final int exitValue=p.exitValue();
    if (exitValue != 0) {
      throw new CLIException("Failed to execute command on azure. Error was: " + readResult);
    }
    return readResult;
  }
 catch (  final IOException ioe) {
    throw new CLIException("Failed to execute get config command",ioe);
  }
}
