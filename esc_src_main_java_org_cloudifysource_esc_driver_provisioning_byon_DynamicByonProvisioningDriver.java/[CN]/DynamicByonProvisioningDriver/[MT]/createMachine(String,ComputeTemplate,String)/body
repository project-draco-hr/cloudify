{
  final CustomNodeImpl customNode=new CustomNodeImpl(PROVIDER_ID,serverName,ip,null,template.getUsername(),template.getPassword(),template.getKeyFile(),serverName);
  try {
    customNode.resolve();
    if (template.getRemoteExecution() == RemoteExecutionModes.WINRM) {
      customNode.setLoginPort(RemoteExecutionModes.WINRM.getDefaultPort());
    }
    IPUtils.validateConnection(customNode.getPrivateIp(),customNode.getLoginPort());
  }
 catch (  Exception e) {
    logger.log(Level.INFO,"Failed to create server on " + customNode.getPrivateIP() + ", connection failed on port "+ customNode.getLoginPort(),e);
    throw new CloudProvisioningException(e);
  }
  return createMachineDetails(customNode,template);
}
