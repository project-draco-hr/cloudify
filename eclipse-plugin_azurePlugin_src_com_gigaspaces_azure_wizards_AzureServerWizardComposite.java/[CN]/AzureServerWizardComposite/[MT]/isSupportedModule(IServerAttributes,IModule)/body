{
  if (server != null && module != null) {
    IServerType serverType=server.getServerType();
    IModuleType mt=module.getModuleType();
    if (!ServerUtil.isSupportedModule(serverType.getRuntimeType().getModuleTypes(),mt)) {
      String type=mt.getName();
      return new Status(IStatus.ERROR,ServerUIPlugin.PLUGIN_ID,NLS.bind(Messages.errorVersionLevel,new Object[]{type,mt.getVersion()}));
    }
    IModule[] rootModules=null;
    try {
      rootModules=server.getRootModules(module,null);
    }
 catch (    CoreException ce) {
      return ce.getStatus();
    }
catch (    Exception e) {
      if (Trace.WARNING) {
        Trace.trace(Trace.STRING_WARNING,"Could not find root module",e);
      }
    }
    if (rootModules != null) {
      if (rootModules.length == 0)       return new Status(IStatus.ERROR,ServerUIPlugin.PLUGIN_ID,Messages.errorRootModule);
      int size=rootModules.length;
      IStatus status=null;
      boolean found=false;
      for (int i=0; i < size; i++) {
        try {
          if (server != null)           status=server.canModifyModules(new IModule[]{rootModules[i]},null,null);
          if (status != null && status.isOK())           found=true;
        }
 catch (        Exception e) {
          if (Trace.WARNING) {
            Trace.trace(Trace.STRING_WARNING,"Could not find root module",e);
          }
        }
      }
      if (!found && status != null)       return status;
    }
  }
  return null;
}
