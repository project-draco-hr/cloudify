{
  if (timeout == 0) {
    throw new IllegalArgumentException("use connect instead of connectAndWait()");
  }
  long end=System.currentTimeMillis() + timeUnit.toMillis(timeout);
  logger.log(Level.INFO,"Waiting for azure deployment to run.");
  waitForAzureDeploymentStatus(AzureDeploymentStatus.Running,ShellUtils.millisUntil(timeoutErrorMessage,end),TimeUnit.MILLISECONDS);
  try {
    String restAdminUrl=getRestAdminUrl(getAzureDeployment());
    waitForConnection(adminFacade,restAdminUrl,ShellUtils.millisUntil(timeoutErrorMessage,end),TimeUnit.MILLISECONDS);
    return new URI(restAdminUrl);
  }
 catch (  URISyntaxException e) {
    throw new CLIException(e);
  }
}
