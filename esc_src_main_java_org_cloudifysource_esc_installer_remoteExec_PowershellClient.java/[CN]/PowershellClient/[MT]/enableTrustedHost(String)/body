{
  List<String> cmd=new ArrayList<String>();
  for (  String cmdElement : POWERSHELL_TRUST_HOST_WINRM)   cmd.add(cmdElement);
  cmd.add("@{TrustedHosts=\"" + ipTarget + "\"}");
  final ProcessBuilder trusCommand=new ProcessBuilder(cmd);
  try {
    final Process trusCmdResult=trusCommand.start();
    final String output=readProcessStream(trusCmdResult,true,IoStreamType.OUTPUT);
    return output;
  }
 catch (  final IOException e) {
    throw new PowershellClientException("Failed to enable trusted host for winrm command: " + e.getMessage(),e);
  }
}
