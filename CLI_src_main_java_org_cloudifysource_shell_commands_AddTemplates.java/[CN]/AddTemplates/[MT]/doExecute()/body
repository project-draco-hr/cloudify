{
  String templatesFolderName=templatesFileOrDir.getName();
  logger.info("Validating tempaltes folder and files at: " + templatesFolderName);
  if (!templatesFileOrDir.exists()) {
    throw new CLIStatusException("templates_file_not_found",templatesFileOrDir.getAbsolutePath());
  }
  int numTemplatesInFolder=0;
  File zipFile=templatesFileOrDir;
  if (templatesFileOrDir.isFile()) {
    if (templatesFolderName.endsWith(".zip") || templatesFolderName.endsWith(".jar")) {
      try {
        numTemplatesInFolder=ServiceReader.readCloudTemplatesFromZip(templatesFileOrDir).size();
      }
 catch (      DSLException e) {
        throw new CLIStatusException("read_dsl_file_failed",templatesFileOrDir,e.getMessage());
      }
    }
 else {
      if (!templatesFolderName.endsWith(DSLUtils.TEMPLATES_DSL_FILE_NAME_SUFFIX)) {
        throw new CLIStatusException("illegal_template_file_name",templatesFolderName);
      }
      File parentFile=templatesFileOrDir.getParentFile();
      File[] actualTemplatesDslFiles=DSLReader.findDefaultDSLFiles(DSLUtils.TEMPLATES_DSL_FILE_NAME_SUFFIX,parentFile);
      if (actualTemplatesDslFiles.length > 1) {
        throw new CLIStatusException("too_many_template_files",Arrays.toString(actualTemplatesDslFiles));
      }
      try {
        numTemplatesInFolder=ServiceReader.readCloudTemplatesFromFile(templatesFileOrDir).size();
      }
 catch (      DSLException e) {
        throw new CLIStatusException("read_dsl_file_failed",templatesFileOrDir,e.getMessage());
      }
      zipFile=Packager.createZipFile("templates",parentFile);
    }
  }
 else {
    try {
      numTemplatesInFolder=ServiceReader.readCloudTemplatesFromDirectory(templatesFileOrDir).size();
    }
 catch (    DSLException e) {
      throw new CLIStatusException("read_dsl_file_failed",templatesFileOrDir,e.getMessage());
    }
    zipFile=Packager.createZipFile("templates",templatesFileOrDir);
  }
  logger.info("Adding " + numTemplatesInFolder + " templates to cloud.");
  List<String> addedTempaltes=adminFacade.addTempaltes(zipFile);
  return getFormattedMessage("templates_added_successfully",Color.GREEN) + getFormatedAddedTemplateNamesList(addedTempaltes);
}
