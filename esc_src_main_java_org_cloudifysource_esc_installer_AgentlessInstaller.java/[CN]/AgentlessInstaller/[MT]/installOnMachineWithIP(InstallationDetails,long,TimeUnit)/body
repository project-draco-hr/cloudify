{
  final long end=System.currentTimeMillis() + unit.toMillis(timeout);
  if (details.getLocator() == null) {
    details.setLocator(details.getPrivateIp());
  }
  logger.fine("Executing agentless installer with the following details:\n" + details.toString());
  final String targetHost=details.isConnectedToPrivateIp() ? details.getPrivateIp() : details.getPublicIp();
  int port=0;
switch (details.getFileTransferMode()) {
case CIFS:
    port=CIFS_PORT;
  break;
case SCP:
port=SSH_PORT;
break;
default :
throw new UnsupportedOperationException("File Transfer Mode: " + details.getFileTransferMode() + " not supported");
}
publishEvent("attempting_to_access_vm",targetHost);
checkConnection(targetHost,port,CalcUtils.millisUntil(end),TimeUnit.MILLISECONDS);
publishEvent("uploading_files_to_node",targetHost);
uploadFilesToServer(details,end,targetHost);
publishEvent("launching_agent_on_node",targetHost);
remoteExecuteAgentOnServer(details,end,targetHost);
publishEvent("install_completed_on_node",targetHost);
}
