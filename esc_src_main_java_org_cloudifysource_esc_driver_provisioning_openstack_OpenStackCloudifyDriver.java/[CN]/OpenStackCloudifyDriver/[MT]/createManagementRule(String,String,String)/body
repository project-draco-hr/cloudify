{
  final PortRange portRange=PortRangeFactory.createPortRange(portRangeString);
  SecurityGroupRulesRequest request;
  for (  final PortRangeEntry entry : portRange.getRanges()) {
    request=new SecurityGroupRulesRequest();
    request.setSecurityGroupId(targetSecurityGroupId).setDirection("ingress").setProtocol("tcp").setPortRangeMax(entry.getTo() == null ? entry.getFrom().toString() : entry.getTo().toString()).setPortRangeMin(entry.getFrom().toString());
    if (cidr == null) {
      request.setRemoteIpPrefix("0.0.0.0/0");
    }
 else {
      request.setRemoteIpPrefix(cidr);
    }
    quantumApi.createSecurityGroupRules(request);
  }
}
