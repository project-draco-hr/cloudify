{
  String responseBody;
  try {
    final HttpResponse response=httpClient.execute(httpMethod);
    final int statusCode=response.getStatusLine().getStatusCode();
    if (statusCode != CloudifyConstants.HTTP_STATUS_CODE_OK) {
      if (logger.isLoggable(Level.FINE)) {
        logger.log(Level.FINE,httpMethod.getURI() + MSG_RESPONSE_CODE + statusCode);
      }
      responseBody=getResponseBody(response,httpMethod);
      if (logger.isLoggable(Level.FINE)) {
        logger.log(Level.FINE,httpMethod.getURI() + " response body " + responseBody);
      }
      try {
        final Map<String,Object> errorMap=GSRestClient.jsonToMap(responseBody);
        final String status=(String)errorMap.get(STATUS_KEY);
        if (ERROR.equals(status)) {
          final String reason=(String)errorMap.get(ERROR);
          @SuppressWarnings("unchecked") final List<String> reasonsArgs=(List<String>)errorMap.get(ERROR_ARGS);
          final ErrorStatusException e=new ErrorStatusException(reason,reasonsArgs != null ? reasonsArgs.toArray() : null);
          logger.log(Level.FINE,reason,e);
          throw e;
        }
      }
 catch (      final IOException e) {
        if (statusCode == CloudifyConstants.HTTP_STATUS_NOT_FOUND) {
          throw new ErrorStatusException(e,"URL_not_found",httpMethod.getURI());
        }
 else         if (statusCode == CloudifyConstants.HTTP_STATUS_ACCESS_DENIED) {
          throw new ErrorStatusException(e,CloudifyErrorMessages.NO_PERMISSION_ACCESS_DENIED.getName(),httpMethod.getURI());
        }
 else         if (statusCode == CloudifyConstants.HTTP_STATUS_BAD_CREDENTIALS) {
          throw new ErrorStatusException(e,CloudifyErrorMessages.BAD_CREDENTIALS.getName(),httpMethod.getURI());
        }
        throw new ErrorStatusException(e,"CLI_unable_to_parse_to_JSON",responseBody);
      }
    }
    responseBody=getResponseBody(response,httpMethod);
    final Map<String,Object> responseMap=GSRestClient.jsonToMap(responseBody);
    return responseJsonKey != null ? responseMap.get(RESPONSE_KEY) : responseMap;
  }
 catch (  final ClientProtocolException e) {
    logger.log(Level.FINE,httpMethod.getURI() + MSG_REST_API_ERR,e);
    throw new ErrorStatusException(e,REASON_CODE_COMM_ERR,httpMethod.getURI(),MSG_REST_API_ERR);
  }
catch (  final IOException e) {
    logger.log(Level.FINE,httpMethod.getURI() + MSG_REST_API_ERR,e);
    throw new ErrorStatusException(e,REASON_CODE_COMM_ERR,httpMethod.getURI(),MSG_REST_API_ERR);
  }
 finally {
    httpMethod.abort();
  }
}
