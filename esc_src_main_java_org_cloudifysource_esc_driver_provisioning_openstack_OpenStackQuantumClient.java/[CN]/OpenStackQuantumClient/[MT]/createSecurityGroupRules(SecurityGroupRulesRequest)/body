{
  if (logger.isLoggable(Level.FINEST)) {
    logger.finest("Create security group rule " + request);
  }
  try {
    final String response=this.getWebResource().path("security-group-rules").type(MediaType.APPLICATION_JSON_TYPE).accept(MediaType.APPLICATION_JSON).header("X-Auth-Token",this.getTokenId()).post(String.class,request.computeRequest());
    final SecurityGroupResponse securityGroup=JsonUtils.mapJsonToObject(SecurityGroupResponse.class,response);
    return securityGroup.getSecurityGroup();
  }
 catch (  final UniformInterfaceException e) {
    if (CONFLICT_STATUS == e.getResponse().getStatus()) {
      logger.warning("Rule already exists or is conflincting with another one: " + request);
      return this.getSecurityGroupsById(request.getSecurityGroupId());
    }
 else {
      throw e;
    }
  }
}
