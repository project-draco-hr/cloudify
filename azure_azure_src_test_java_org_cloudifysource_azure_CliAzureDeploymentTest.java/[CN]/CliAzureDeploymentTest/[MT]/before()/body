{
  isDebugMode=Boolean.parseBoolean(System.getProperty(IS_DEBUG_MODE_SYSTEM_PROPERTY,Boolean.toString(false)));
  String localWorkingDirPath=System.getProperty(LOCAL_WORKING_DIR_SYSTEM_PROPERTY_KEY);
  Assert.assertNotNull(LOCAL_WORKING_DIR_SYSTEM_PROPERTY_KEY + " system property has to exists",localWorkingDirPath);
  File localWorkingDir=new File(localWorkingDirPath);
  Assert.assertTrue(localWorkingDir.getPath() + " does not exist",localWorkingDir.isDirectory());
  File gigaSpacesCloudifyDir=new File(localWorkingDir,GIGASPACES_LATEST_HOME);
  Assert.assertTrue(gigaSpacesCloudifyDir.getPath() + " does not exist",gigaSpacesCloudifyDir.isDirectory());
  applicationFile=new File(gigaSpacesCloudifyDir,RELATIVE_APPLICATION_EXAMPLE_PATH);
  Assert.assertTrue(applicationFile.getPath() + " does not exist",applicationFile.isDirectory());
  cliExecutablePath=new File(gigaSpacesCloudifyDir,RELATIVE_CLI_PATH);
  File azureConfigExec=new File(gigaSpacesCloudifyDir,RELATIVE_AZURE_CONFIG_EXEC_PATH);
  File azurePropertiesFile=new File(gigaSpacesCloudifyDir,RELATIVE_AZURE_PROPERTIES_PATH);
  File cscfgFile=new File(cliExecutablePath.getParent(),RELATIVE_WORKER_ROLE_DIR + "\\ServiceConfiguration.Cloud.cscfg");
  AzureDeploymentConfigurationFile cscfg=new AzureDeploymentConfigurationFile(cscfgFile);
  cscfg.setUploadAgentLogs(true);
  cscfg.setUploadAllLogs(true);
  cscfg.flush();
  Properties newAzureProps=new Properties();
  newAzureProps.setProperty(AZURE_PROPERTIES_ACCOUNT_NAME_KEY,credentials.getBlobStorageAccountName());
  newAzureProps.setProperty(AZURE_PROPERTIES_ACCOUNT_KEY_KEY,credentials.getBlobStorageAccountKey());
  newAzureProps.setProperty(AZURE_PROPERTIES_CONTAINER_NAME_KEY,AZURE_CONTAINER_NAME);
  newAzureProps.setProperty(AZURE_PROPERTIES_WORKER_ROLE_FOLDER_KEY,RELATIVE_WORKER_ROLE_DIR);
  newAzureProps.setProperty(AZURE_PROPERTIES_CS_PACK_FOLDER_KEY,CS_PACK_FOLDER);
  newAzureProps.setProperty(AZURE_PROPERTIES_RDP_CERT_FILE_KEY,RDP_CERT_FILE);
  newAzureProps.setProperty(AZURE_PROPERTIES_RDP_PFX_FILE_KEY,RDP_PFX_FILE);
  newAzureProps.setProperty(AZURE_PROPERITES_CERTIFICATE_THUMBPRINT_KEY,credentials.getHostedServicesCertificateThumbrint());
  newAzureProps.setProperty(AZURE_PROPERITES_SUBSCRIPTION_ID_KEY,credentials.getHostedServicesSubscriptionId());
  newAzureProps.setProperty(AZURE_PROPERTIES_RDP_LOGIN_USERNAME_KEY,AZURE_RDP_LOGIN_USERNAME);
  newAzureProps.setProperty(AZURE_PROPERTIES_RDP_LOGIN_ENCRYPTED_PASSWORD,AZURE_RDP_LOGIN_ENCRYPTED_PASSWORD);
  log("Overriding azure.properties file");
  FileOutputStream fos=new FileOutputStream(azurePropertiesFile);
  newAzureProps.store(fos,null);
  fos.close();
  deployment=new AzureDeploymentWrapper(azureConfigExec,credentials.getHostedServicesSubscriptionId(),credentials.getHostedServicesCertificateThumbrint(),AZURE_HOSTED_SERVICE,AZURE_SLOT,null,null,null,null);
}
