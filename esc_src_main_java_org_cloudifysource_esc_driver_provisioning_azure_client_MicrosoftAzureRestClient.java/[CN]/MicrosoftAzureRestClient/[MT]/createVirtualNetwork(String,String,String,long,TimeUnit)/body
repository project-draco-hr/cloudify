{
  GlobalNetworkConfiguration networkConfiguration=requestBodyBuilder.buildGlobalNetworkConfiguration(addressSpace,affinityGroup,networkName);
  if (networkExists(networkName)) {
    logger.fine("Found an existing virtual netowrk : " + networkName);
    return;
  }
  String xmlRequest=MicrosoftAzureModelUtils.marshall(networkConfiguration,true);
  ClientResponse response=doPut("/" + subscriptionId + "/services/networking/media",xmlRequest,"text/plain");
  String requestId=extractRequestId(response);
  waitForRequestToFinish(requestId,timeout,timeunit);
  logger.fine("created virtual network : " + networkName);
}
