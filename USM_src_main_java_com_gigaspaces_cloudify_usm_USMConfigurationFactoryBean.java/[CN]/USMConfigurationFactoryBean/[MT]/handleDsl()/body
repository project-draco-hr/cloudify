{
  File dslFile;
  if (serviceFileName == null) {
    dslFile=ServiceReader.findServiceFile(puExtDir);
  }
 else {
    dslFile=new File(puExtDir,serviceFileName);
    if (!dslFile.isFile()) {
      throw new FileNotFoundException("Cannot find file " + dslFile.getAbsolutePath());
    }
  }
  logger.info("Found service configuration file: " + dslFile.getAbsolutePath());
  DSLServiceCompilationResult compilationResult;
  try {
    if (this.clusterInfo == null) {
      throw new IllegalStateException("The cluster information is missing. " + "If running in the integrated container, use the -cluster option to set the cluster info manually");
    }
    compilationResult=ServiceReader.getServiceFromFile(dslFile,this.puExtDir,USMUtils.getAdmin(),this.clusterInfo,this.propertiesFileName,this.isRunningInGSC);
  }
 catch (  final Exception e) {
    throw new USMException("Failed to read service from file: " + dslFile,e);
  }
  final DSLConfiguration config=new DSLConfiguration(compilationResult.getService(),compilationResult.getContext(),this.puExtDir,dslFile);
  return config;
}
