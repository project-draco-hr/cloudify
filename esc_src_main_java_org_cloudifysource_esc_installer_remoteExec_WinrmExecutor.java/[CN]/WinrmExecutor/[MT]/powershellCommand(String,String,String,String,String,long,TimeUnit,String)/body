{
  logger.fine("Executing: " + command + " on: "+ targetHost);
  logger.fine("Checking if powershell is installed");
  try {
    checkPowershellInstalled();
  }
 catch (  final IOException e) {
    throw new InstallerException("Error while trying to find powershell.exe",e);
  }
  logger.fine("Checking WinRM Connection");
  AgentlessInstaller.checkConnection(targetHost,RemoteExecutionModes.WINRM.getPort(),millisUntil,milliseconds);
  logger.fine("Executing remote command");
  try {
    invokeRemotePowershellCommand(targetHost,command,username,password,localDir);
  }
 catch (  final FileNotFoundException e) {
    throw new InstallerException("Failed to invoke remote powershell command",e);
  }
}
