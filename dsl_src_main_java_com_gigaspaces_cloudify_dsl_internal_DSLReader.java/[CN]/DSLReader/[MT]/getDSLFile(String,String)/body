{
  if (propertyKey != null) {
    final String providedFileName=properties.getProperty(propertyKey);
    if (providedFileName != null) {
      File providedFile=new File(this.workFolder,providedFileName);
      if (providedFile.exists()) {
        return providedFile;
      }
 else {
        throw new FileNotFoundException("Could not find DSL file with provided name: " + providedFileName);
      }
    }
  }
  File[] matchingFiles=this.workFolder.listFiles(new FilenameFilter(){
    @Override public boolean accept(    File dir,    String name){
      return name.endsWith(fileNameSuffix);
    }
  }
);
  if (matchingFiles.length == 0) {
    return null;
  }
  if (matchingFiles.length > 1) {
    throw new IllegalStateException("Found multiple DSL files with the suffix " + fileNameSuffix + ". Only one may be provided");
  }
  return matchingFiles[0];
}
