{
  createConditionLatch(timeout,timeunit).waitFor(new ConditionLatch.Predicate(){
    boolean messagePublished=false;
    @Override public boolean isDone() throws CLIException, InterruptedException {
      final List<String> applications=adminFacade.getApplicationsList();
      boolean done=true;
      for (      final String applicationName : applications) {
        if (!MANAGEMENT_APPLICATION.equals(applicationName)) {
          done=false;
          break;
        }
      }
      if (!done) {
        if (!messagePublished) {
          publishEvent("Waiting for all applications to uninstall");
          messagePublished=true;
        }
 else {
          publishEvent(null);
        }
        logger.fine("Waiting for all applications to uninstall");
      }
      return done;
    }
  }
);
}
