{
  try {
    final KeyStore trustStore=KeyStore.getInstance(KeyStore.getDefaultType());
    trustStore.load(null,null);
    final SSLSocketFactory sf=new RestSSLSocketFactory(trustStore);
    sf.setHostnameVerifier(SSLSocketFactory.ALLOW_ALL_HOSTNAME_VERIFIER);
    final HttpParams params=new BasicHttpParams();
    HttpProtocolParams.setVersion(params,HttpVersion.HTTP_1_1);
    HttpProtocolParams.setContentCharset(params,HTTP.UTF_8);
    final SchemeRegistry registry=new SchemeRegistry();
    registry.register(new Scheme(HTTPS,sf,url.getPort()));
    final ClientConnectionManager ccm=new ThreadSafeClientConnManager(params,registry);
    return new DefaultHttpClient(ccm,params);
  }
 catch (  KeyStoreException e) {
    throw new RestException(e);
  }
catch (  NoSuchAlgorithmException e) {
    throw new RestException(e);
  }
catch (  CertificateException e) {
    throw new RestException(e);
  }
catch (  IOException e) {
    throw new RestException(e);
  }
catch (  KeyManagementException e) {
    throw new RestException(e);
  }
catch (  UnrecoverableKeyException e) {
    throw new RestException(e);
  }
}
