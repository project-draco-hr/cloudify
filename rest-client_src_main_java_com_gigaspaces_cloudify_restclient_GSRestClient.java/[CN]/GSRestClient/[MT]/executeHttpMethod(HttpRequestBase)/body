{
  String responseBody;
  try {
    final HttpResponse response=httpClient.execute(httpMethod);
    int statusCode=response.getStatusLine().getStatusCode();
    if (statusCode != HTTP_STATUS_OK) {
      logger.log(Level.FINE,httpMethod.getURI() + " response code " + statusCode);
      responseBody=getResponseBody(response);
      try {
        Map<String,Object> errorMap=GSRestClient.jsonToMap(responseBody);
        throw new ErrorStatusException("Remote_rest_gateway_exception",errorMap.get("error"));
      }
 catch (      IOException e) {
        if (statusCode == NOT_FOUND_404_ERROR_CODE) {
          throw new ErrorStatusException("URL_not_found",httpMethod.getURI());
        }
        throw new ErrorStatusException("CLI_unable_to_parse_to_JSON",responseBody);
      }
    }
    responseBody=getResponseBody(response);
    final Map<String,Object> responseMap=GSRestClient.jsonToMap(responseBody);
    final String status=(String)responseMap.get(STATUS_KEY);
    if (ERROR.equals(status)) {
      final String reason=(String)responseMap.get(ERROR);
      @SuppressWarnings("unchecked") final List<String> reasonsArgs=(ArrayList<String>)responseMap.get(ERROR_ARGS);
      final ErrorStatusException e=new ErrorStatusException(reason,reasonsArgs != null ? reasonsArgs.toArray() : null);
      logger.log(Level.FINE,reason,e);
      throw e;
    }
    return responseMap.get(RESPONSE_KEY);
  }
 catch (  final ClientProtocolException e) {
    logger.log(Level.FINE,httpMethod.getURI() + " Rest api error",e);
    throw new ErrorStatusException("comm_error",e,e.getMessage());
  }
catch (  final IOException e) {
    logger.log(Level.FINE,httpMethod.getURI() + " Rest api error",e);
    throw new ErrorStatusException("comm_error",e,e.getMessage());
  }
 finally {
    httpMethod.abort();
  }
}
