{
  logger.fine(EventsUtils.getThreadId() + "Could not find events for key " + key+ " in cache. Loading from container logs...");
  DeploymentEvents events=new DeploymentEvents();
  Set<GridServiceContainer> containersForDeployment=containerProvider.getContainersForDeployment(key.getDeploymentId());
  int index=-1;
  for (  GridServiceContainer container : containersForDeployment) {
    LogEntryMatcherProviderKey logEntryMatcherProviderKey=createKey(container,key);
    LogEntries logEntries=container.logEntries(matcherProvider.get(logEntryMatcherProviderKey));
    for (    LogEntry logEntry : logEntries) {
      if (logEntry.isLog()) {
        DeploymentEvent event=EventsUtils.logToEvent(logEntry,logEntries.getHostName(),logEntries.getHostAddress());
        event.setIndex(++index);
        events.getEvents().add(event);
      }
    }
  }
  EventsCacheValue value=new EventsCacheValue();
  value.setLastEventIndex(index);
  value.setEvents(events);
  value.setLastRefreshedTimestamp(System.currentTimeMillis());
  return value;
}
