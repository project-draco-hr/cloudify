{
  String applicationName=this.getCurrentApplicationName();
  if (applicationName == null) {
    applicationName=CloudifyConstants.DEFAULT_APPLICATION_NAME;
  }
  final int initialNumberOfInstances=adminFacade.getInstanceList(applicationName,serviceName).size();
  if (initialNumberOfInstances == count) {
    return getFormattedMessage("num_instanes_already_met",count);
  }
  Map<String,String> response=adminFacade.setInstances(applicationName,serviceName,count,timeout);
  if (response.containsKey(CloudifyConstants.LIFECYCLE_EVENT_CONTAINER_ID)) {
    String pollingID=response.get(CloudifyConstants.LIFECYCLE_EVENT_CONTAINER_ID);
    boolean waitForLifecycleEvents=this.adminFacade.waitForLifecycleEvents(pollingID,timeout);
    if (!waitForLifecycleEvents) {
      throw new TimeoutException(TIMEOUT_ERROR_MESSAGE);
    }
  }
 else {
    logger.info("Failed to retrieve lifecycle logs from rest. " + "Check logs for more details.");
  }
  return getFormattedMessage("set_instances_completed_successfully",serviceName,count);
}
