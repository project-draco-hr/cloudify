{
  if (propertiesFileName != null) {
    File propertiesFile=new File(workDir,propertiesFileName);
    if (!propertiesFile.exists()) {
      throw new FileNotFoundException("Could not find file: " + propertiesFileName + " in directory: "+ workDir);
    }
    ConfigObject config=new ConfigSlurper().parse(propertiesFile.toURI().toURL());
    return config;
  }
 else {
    String baseFileName=dslFile.getName();
    String[] parts=baseFileName.split(Pattern.quote("."));
    if (parts.length > 0) {
      baseFileName=parts[0];
    }
    String defaultPropertiesFileName=baseFileName + ".properties";
    String actualPropertiesFileName=defaultPropertiesFileName;
    try {
      return createServiceProperties(dslFile,workDir,actualPropertiesFileName);
    }
 catch (    FileNotFoundException e) {
      return new LinkedHashMap<Object,Object>();
    }
  }
}
