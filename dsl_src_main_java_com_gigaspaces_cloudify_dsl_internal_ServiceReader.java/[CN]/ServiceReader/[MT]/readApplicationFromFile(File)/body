{
  if (!dslFile.exists()) {
    throw new FileNotFoundException(dslFile.getAbsolutePath());
  }
  final GroovyShell gs=ServiceReader.createGroovyShellForApplication(dslFile);
  gs.getContext().setProperty(DSLUtils.APPLICATION_DIR,dslFile.getParentFile().getAbsolutePath());
  Object result=null;
  FileReader reader=null;
  try {
    reader=new FileReader(dslFile);
    result=gs.evaluate(reader,"application");
  }
 catch (  final CompilationFailedException e) {
    throw new IllegalArgumentException("The file " + dslFile + " could not be compiled: "+ e.getMessage(),e);
  }
catch (  final IOException e) {
    throw new IllegalStateException("The file " + dslFile + " could not be read",e);
  }
 finally {
    if (reader != null) {
      reader.close();
    }
  }
  if (result == null) {
    throw new IllegalStateException("The file: " + dslFile + " evaluates to null, not to an application object");
  }
  if (!(result instanceof Application)) {
    throw new IllegalStateException("The file: " + dslFile + " did not evaluate to the required object type");
  }
  final Application application=(Application)result;
  return application;
}
